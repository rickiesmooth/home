{"ast":null,"code":"import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import{Platform,UnavailabilityError}from'@unimodules/core';import invariant from'invariant';import Dimensions from\"react-native-web/dist/exports/Dimensions\";function getBasePath(_ref){var httpServerLocation=_ref.httpServerLocation;if(httpServerLocation[0]==='/'){return httpServerLocation.substr(1);}return httpServerLocation;}function getScale(){return Dimensions.get('window').scale;}function getScaledAssetPath(asset){var scale=AssetSourceResolver.pickScale(asset.scales,getScale());var scaleSuffix=scale===1?'':'@'+scale+'x';var assetDir=getBasePath(asset);return assetDir+'/'+asset.name+scaleSuffix+'.'+asset.type;}var AssetSourceResolver=function(){function AssetSourceResolver(serverUrl,jsbundleUrl,asset){_classCallCheck(this,AssetSourceResolver);this.serverUrl=serverUrl;this.jsbundleUrl=jsbundleUrl;this.asset=asset;}_createClass(AssetSourceResolver,[{key:\"isLoadedFromServer\",value:function isLoadedFromServer(){return!!this.serverUrl;}},{key:\"isLoadedFromFileSystem\",value:function isLoadedFromFileSystem(){return!!(this.jsbundleUrl&&this.jsbundleUrl.startsWith('file://'));}},{key:\"defaultAsset\",value:function defaultAsset(){if(this.isLoadedFromServer()){return this.assetServerURL();}return this.scaledAssetURLNearBundle();}},{key:\"assetServerURL\",value:function assetServerURL(){invariant(!!this.serverUrl,'need server to load from');return this.fromSource(this.serverUrl+getScaledAssetPath(this.asset)+'?platform='+Platform.OS+'&hash='+this.asset.hash);}},{key:\"scaledAssetPath\",value:function scaledAssetPath(){return this.fromSource(getScaledAssetPath(this.asset));}},{key:\"scaledAssetURLNearBundle\",value:function scaledAssetURLNearBundle(){var path=this.jsbundleUrl||'file://';return this.fromSource(path+getScaledAssetPath(this.asset));}},{key:\"resourceIdentifierWithoutScale\",value:function resourceIdentifierWithoutScale(){throw new UnavailabilityError('react-native','resourceIdentifierWithoutScale()');}},{key:\"drawableFolderInBundle\",value:function drawableFolderInBundle(){throw new UnavailabilityError('react-native','drawableFolderInBundle()');}},{key:\"fromSource\",value:function fromSource(source){return{__packager_asset:true,width:this.asset.width,height:this.asset.height,uri:source,scale:AssetSourceResolver.pickScale(this.asset.scales,getScale())};}}],[{key:\"pickScale\",value:function pickScale(scales,deviceScale){for(var i=0;i<scales.length;i++){if(scales[i]>=deviceScale){return scales[i];}}return scales[scales.length-1]||1;}}]);return AssetSourceResolver;}();export{AssetSourceResolver as default};","map":{"version":3,"sources":["/home/rick/dev/cool-home/node_modules/expo-asset/build/AssetSourceResolver.web.js"],"names":["Platform","UnavailabilityError","invariant","getBasePath","httpServerLocation","substr","getScale","Dimensions","get","scale","getScaledAssetPath","asset","AssetSourceResolver","pickScale","scales","scaleSuffix","assetDir","name","type","serverUrl","jsbundleUrl","startsWith","isLoadedFromServer","assetServerURL","scaledAssetURLNearBundle","fromSource","OS","hash","path","source","__packager_asset","width","height","uri","deviceScale","i","length"],"mappings":"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","sourcesContent":["import { Platform, UnavailabilityError } from '@unimodules/core';\nimport invariant from 'invariant';\nimport { Dimensions } from 'react-native';\nfunction getBasePath({ httpServerLocation }) {\n    if (httpServerLocation[0] === '/') {\n        return httpServerLocation.substr(1);\n    }\n    return httpServerLocation;\n}\nfunction getScale() {\n    return Dimensions.get('window').scale;\n}\nfunction getScaledAssetPath(asset) {\n    const scale = AssetSourceResolver.pickScale(asset.scales, getScale());\n    const scaleSuffix = scale === 1 ? '' : '@' + scale + 'x';\n    const assetDir = getBasePath(asset);\n    return assetDir + '/' + asset.name + scaleSuffix + '.' + asset.type;\n}\nexport default class AssetSourceResolver {\n    constructor(serverUrl, jsbundleUrl, asset) {\n        this.serverUrl = serverUrl;\n        this.jsbundleUrl = jsbundleUrl;\n        this.asset = asset;\n    }\n    isLoadedFromServer() {\n        return !!this.serverUrl;\n    }\n    isLoadedFromFileSystem() {\n        return !!(this.jsbundleUrl && this.jsbundleUrl.startsWith('file://'));\n    }\n    defaultAsset() {\n        if (this.isLoadedFromServer()) {\n            return this.assetServerURL();\n        }\n        return this.scaledAssetURLNearBundle();\n    }\n    assetServerURL() {\n        invariant(!!this.serverUrl, 'need server to load from');\n        return this.fromSource(this.serverUrl +\n            getScaledAssetPath(this.asset) +\n            '?platform=' +\n            Platform.OS +\n            '&hash=' +\n            this.asset.hash);\n    }\n    scaledAssetPath() {\n        return this.fromSource(getScaledAssetPath(this.asset));\n    }\n    scaledAssetURLNearBundle() {\n        const path = this.jsbundleUrl || 'file://';\n        return this.fromSource(path + getScaledAssetPath(this.asset));\n    }\n    resourceIdentifierWithoutScale() {\n        throw new UnavailabilityError('react-native', 'resourceIdentifierWithoutScale()');\n    }\n    drawableFolderInBundle() {\n        throw new UnavailabilityError('react-native', 'drawableFolderInBundle()');\n    }\n    fromSource(source) {\n        return {\n            __packager_asset: true,\n            width: this.asset.width,\n            height: this.asset.height,\n            uri: source,\n            scale: AssetSourceResolver.pickScale(this.asset.scales, getScale()),\n        };\n    }\n    static pickScale(scales, deviceScale) {\n        for (let i = 0; i < scales.length; i++) {\n            if (scales[i] >= deviceScale) {\n                return scales[i];\n            }\n        }\n        return scales[scales.length - 1] || 1;\n    }\n}\n//# sourceMappingURL=AssetSourceResolver.web.js.map"]},"metadata":{},"sourceType":"module"}