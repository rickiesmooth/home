{"ast":null,"code":"import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _toConsumableArray from\"@babel/runtime/helpers/toConsumableArray\";import _defineProperty from\"@babel/runtime/helpers/defineProperty\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import React from\"react\";import{createStackNavigator}from\"@react-navigation/stack\";import{useLinking,NavigationNativeContainer}from\"@react-navigation/native\";import{getStateFromPath as _getStateFromPath}from\"@react-navigation/core\";import AsyncStorage from\"react-native-web/dist/exports/AsyncStorage\";import AuthFlow from\"./AuthFlow\";var Stack=createStackNavigator();var PERSISTENCE_KEY=\"NAVIGATION_STATE\";export default function Root(){var containerRef=React.useRef();var _useLinking=useLinking(containerRef,{prefixes:[],getStateFromPath:function getStateFromPath(path){var state=_getStateFromPath(path);return{routes:[{name:\"root\",state:_objectSpread({},state,{routes:[{name:\"home\"}].concat(_toConsumableArray(state?state.routes:[]))})}]};}}),getInitialState=_useLinking.getInitialState;var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),isReady=_React$useState2[0],setIsReady=_React$useState2[1];var _React$useState3=React.useState(),_React$useState4=_slicedToArray(_React$useState3,2),initialState=_React$useState4[0],setInitialState=_React$useState4[1];React.useEffect(function(){var restoreState=function restoreState(){var state,savedState;return _regeneratorRuntime.async(function restoreState$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return _regeneratorRuntime.awrap(getInitialState());case 3:state=_context.sent;if(!(state===undefined)){_context.next=9;break;}_context.next=7;return _regeneratorRuntime.awrap(AsyncStorage.getItem(PERSISTENCE_KEY));case 7:savedState=_context.sent;state=savedState?JSON.parse(savedState):undefined;case 9:if(state!==undefined){setInitialState(state);}case 10:_context.prev=10;setIsReady(true);return _context.finish(10);case 13:case\"end\":return _context.stop();}}},null,null,[[0,,10,13]]);};restoreState();},[getInitialState]);if(!isReady){return null;}return React.createElement(NavigationNativeContainer,{ref:containerRef,initialState:initialState,onStateChange:function onStateChange(state){return AsyncStorage.setItem(PERSISTENCE_KEY,JSON.stringify(state));}},React.createElement(Stack.Navigator,null,React.createElement(Stack.Screen,{key:name,name:name,component:AuthFlow,options:{header:null}})));}","map":{"version":3,"sources":["/home/rick/dev/cool-home/src/navigation/index.tsx"],"names":["React","createStackNavigator","useLinking","NavigationNativeContainer","getStateFromPath","AuthFlow","Stack","PERSISTENCE_KEY","Root","containerRef","useRef","prefixes","path","state","routes","name","getInitialState","useState","isReady","setIsReady","initialState","setInitialState","useEffect","restoreState","undefined","AsyncStorage","getItem","savedState","JSON","parse","setItem","stringify","header"],"mappings":"qhCAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,oBAAT,KAAqC,yBAArC,CACA,OACEC,UADF,CAEEC,yBAFF,KAGO,0BAHP,CAIA,OAEEC,gBAAgB,GAAhBA,CAAAA,iBAFF,KAGO,wBAHP,C,qEAKA,MAAOC,CAAAA,QAAP,kBAIA,GAAMC,CAAAA,KAAK,CAAGL,oBAAoB,EAAlC,CACA,GAAMM,CAAAA,eAAe,CAAG,kBAAxB,CAEA,cAAe,SAASC,CAAAA,IAAT,EAAgB,CAC7B,GAAMC,CAAAA,YAAY,CAAGT,KAAK,CAACU,MAAN,EAArB,CAD6B,gBAGDR,UAAU,CAACO,YAAD,CAAe,CACnDE,QAAQ,CAAE,EADyC,CAEnDP,gBAAgB,CAAE,0BAAAQ,IAAI,CAAI,CACxB,GAAMC,CAAAA,KAAK,CAAGT,iBAAgB,CAACQ,IAAD,CAA9B,CACA,MAAO,CACLE,MAAM,CAAE,CACN,CACEC,IAAI,CAAE,MADR,CAEEF,KAAK,kBACAA,KADA,EAEHC,MAAM,EAAG,CAAEC,IAAI,CAAE,MAAR,CAAH,4BAAyBF,KAAK,CAAGA,KAAK,CAACC,MAAT,CAAkB,EAAhD,EAFH,EAFP,CADM,CADH,CAAP,CAWD,CAfkD,CAAf,CAHT,CAGrBE,eAHqB,aAGrBA,eAHqB,qBAoBChB,KAAK,CAACiB,QAAN,CAAe,KAAf,CApBD,oDAoBtBC,OApBsB,qBAoBbC,UApBa,0CAqBWnB,KAAK,CAACiB,QAAN,EArBX,qDAqBtBG,YArBsB,qBAqBRC,eArBQ,qBAuB7BrB,KAAK,CAACsB,SAAN,CAAgB,UAAM,CACpB,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,+MAECP,eAAe,EAFhB,SAEbH,KAFa,oBAGbA,KAAK,GAAKW,SAHG,2EAIUC,YAAY,CAACC,OAAb,CAAqBnB,eAArB,CAJV,SAIToB,UAJS,eAKfd,KAAK,CAAGc,UAAU,CAAGC,IAAI,CAACC,KAAL,CAAWF,UAAX,CAAH,CAA4BH,SAA9C,CALe,OAQjB,GAAIX,KAAK,GAAKW,SAAd,CAAyB,CACvBH,eAAe,CAACR,KAAD,CAAf,CACD,CAVgB,yBAYjBM,UAAU,CAAC,IAAD,CAAV,CAZiB,iGAArB,CAgBAI,YAAY,GACb,CAlBD,CAkBG,CAACP,eAAD,CAlBH,EAoBA,GAAI,CAACE,OAAL,CAAc,CACZ,MAAO,KAAP,CACD,CAED,MACE,qBAAC,yBAAD,EACE,GAAG,CAAET,YADP,CAEE,YAAY,CAAEW,YAFhB,CAGE,aAAa,CAAE,uBAAAP,KAAK,QAClBY,CAAAA,YAAY,CAACK,OAAb,CAAqBvB,eAArB,CAAsCqB,IAAI,CAACG,SAAL,CAAelB,KAAf,CAAtC,CADkB,EAHtB,EAOE,oBAAC,KAAD,CAAO,SAAP,MACE,oBAAC,KAAD,CAAO,MAAP,EACE,GAAG,CAAEE,IADP,CAEE,IAAI,CAAEA,IAFR,CAGE,SAAS,CAAEV,QAHb,CAIE,OAAO,CAAE,CAAE2B,MAAM,CAAE,IAAV,CAJX,EADF,CAPF,CADF,CAkBD","sourcesContent":["import React from \"react\";\nimport { createStackNavigator } from \"@react-navigation/stack\";\nimport {\n  useLinking,\n  NavigationNativeContainer\n} from \"@react-navigation/native\";\nimport {\n  NavigationContainerRef,\n  getStateFromPath\n} from \"@react-navigation/core\";\nimport { AsyncStorage } from \"react-native\";\nimport AuthFlow from \"./AuthFlow\";\ntype RootStackParamList = {\n  Home: undefined;\n};\nconst Stack = createStackNavigator<RootStackParamList>();\nconst PERSISTENCE_KEY = \"NAVIGATION_STATE\";\n\nexport default function Root() {\n  const containerRef = React.useRef<NavigationContainerRef>();\n\n  const { getInitialState } = useLinking(containerRef, {\n    prefixes: [],\n    getStateFromPath: path => {\n      const state = getStateFromPath(path);\n      return {\n        routes: [\n          {\n            name: \"root\",\n            state: {\n              ...state,\n              routes: [{ name: \"home\" }, ...(state ? state.routes : [])]\n            }\n          }\n        ]\n      };\n    }\n  });\n  const [isReady, setIsReady] = React.useState(false);\n  const [initialState, setInitialState] = React.useState<any | undefined>();\n\n  React.useEffect(() => {\n    const restoreState = async () => {\n      try {\n        let state = await getInitialState();\n        if (state === undefined) {\n          const savedState = await AsyncStorage.getItem(PERSISTENCE_KEY);\n          state = savedState ? JSON.parse(savedState) : undefined;\n        }\n\n        if (state !== undefined) {\n          setInitialState(state);\n        }\n      } finally {\n        setIsReady(true);\n      }\n    };\n\n    restoreState();\n  }, [getInitialState]);\n\n  if (!isReady) {\n    return null;\n  }\n\n  return (\n    <NavigationNativeContainer\n      ref={containerRef}\n      initialState={initialState}\n      onStateChange={state =>\n        AsyncStorage.setItem(PERSISTENCE_KEY, JSON.stringify(state))\n      }\n    >\n      <Stack.Navigator>\n        <Stack.Screen\n          key={name}\n          name={name}\n          component={AuthFlow}\n          options={{ header: null }}\n        />\n      </Stack.Navigator>\n    </NavigationNativeContainer>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}