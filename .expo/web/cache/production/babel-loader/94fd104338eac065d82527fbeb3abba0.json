{"ast":null,"code":"import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import React from\"react\";import View from\"react-native-web/dist/exports/View\";import Text from\"react-native-web/dist/exports/Text\";import Button from\"react-native-web/dist/exports/Button\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import TouchableOpacity from\"react-native-web/dist/exports/TouchableOpacity\";import ActivityIndicator from\"react-native-web/dist/exports/ActivityIndicator\";import Auth from\"@aws-amplify/auth\";import{createStackNavigator}from\"@react-navigation/stack\";import{Input}from\"../components/Elements/Input/Input\";var LoginStack=createStackNavigator();var SignIn=function SignIn(_ref){var navigation=_ref.navigation,name=_ref.route.name;var _React$useState=React.useState(\"\"),_React$useState2=_slicedToArray(_React$useState,2),password=_React$useState2[0],setPassword=_React$useState2[1];var _React$useState3=React.useState(\"\"),_React$useState4=_slicedToArray(_React$useState3,2),username=_React$useState4[0],setUsername=_React$useState4[1];var _React$useState5=React.useState(\"\"),_React$useState6=_slicedToArray(_React$useState5,2),error=_React$useState6[0],setError=_React$useState6[1];var _React$useState7=React.useState(false),_React$useState8=_slicedToArray(_React$useState7,2),isLoading=_React$useState8[0],setIsLoading=_React$useState8[1];function handleSubmit(){setIsLoading(true);Auth.signIn({username:username,password:password}).catch(function(err){setIsLoading(false);setError(err.message);});}var isFirst=navigation.isFirstRouteInParent();if(isLoading){return React.createElement(View,{style:styles.content},React.createElement(ActivityIndicator,null));}return React.createElement(View,{style:styles.content},error?React.createElement(View,{style:styles.error},React.createElement(Text,{style:[styles.text,{color:\"white\"}]},error)):null,React.createElement(Input,{\"data-test\":\"username-input\",placeholder:\"Username\",onChangeText:setUsername}),React.createElement(Input,{placeholder:\"Password\",secureTextEntry:true,onChangeText:setPassword,\"data-test\":\"sign-in-password-input\"}),React.createElement(Button,{\"data-test\":\"sign-in-sign-in-button\",onPress:handleSubmit,title:\"Login\"}),React.createElement(TouchableOpacity,{style:styles.otherOption,onPress:function onPress(){return isFirst?navigation.navigate(\"signup\"):navigation.goBack();}},React.createElement(Text,{style:styles.text},\"Or sign up here\")));};var SignUp=function SignUp(_ref2){var navigation=_ref2.navigation;var _React$useState9=React.useState(\"\"),_React$useState10=_slicedToArray(_React$useState9,2),password=_React$useState10[0],setPassword=_React$useState10[1];var _React$useState11=React.useState(\"\"),_React$useState12=_slicedToArray(_React$useState11,2),username=_React$useState12[0],setUsername=_React$useState12[1];var _React$useState13=React.useState(\"\"),_React$useState14=_slicedToArray(_React$useState13,2),error=_React$useState14[0],setError=_React$useState14[1];var _React$useState15=React.useState(),_React$useState16=_slicedToArray(_React$useState15,2),signupResult=_React$useState16[0],setSignupResult=_React$useState16[1];var _React$useState17=React.useState(),_React$useState18=_slicedToArray(_React$useState17,2),code=_React$useState18[0],setCode=_React$useState18[1];function handleConfirm(){if(code){Auth.confirmSignUp(username,code).then(function(){return Auth.signIn(username,password);}).catch(function(err){return console.log(err);});}}function handleSubmit(){Auth.signUp({username:username,password:password}).then(function(res){return setSignupResult(res);}).catch(function(e){return setError(e.message);});}if(signupResult){return React.createElement(View,{style:styles.content},React.createElement(Text,{style:styles.text},\"we've your confirmation code to \"+signupResult.codeDeliveryDetails.Destination),React.createElement(Input,{key:\"code\",placeholder:\"enter code here\",onChangeText:setCode}),React.createElement(Button,{onPress:handleConfirm,title:\"confirm code\"}));}return React.createElement(View,{style:styles.content},error?React.createElement(View,{style:styles.error},React.createElement(Text,{style:[styles.text,{color:\"white\"}]},error)):null,React.createElement(Input,{placeholder:\"Username\",onChangeText:setUsername}),React.createElement(Input,{placeholder:\"Password\",secureTextEntry:true,onChangeText:setPassword}),React.createElement(Button,{onPress:handleSubmit,title:\"Sign up\"}),React.createElement(TouchableOpacity,{style:styles.otherOption,onPress:function onPress(){return navigation.navigate(\"signup\");}},React.createElement(Text,{style:styles.text},\"Or sign up here\")));};export var SignInNavigator=function SignInNavigator(){return React.createElement(LoginStack.Navigator,{initialRouteName:\"signin\"},React.createElement(LoginStack.Screen,{name:\"signin\",options:{title:\"Sign In\"},component:SignIn}),React.createElement(LoginStack.Screen,{name:\"signup\",options:{title:\"Sign Up\"},component:SignUp}));};var styles=StyleSheet.create({content:{flex:1,padding:16,justifyContent:\"center\",margin:\"auto\",maxWidth:500,width:\"100%\"},button:{margin:8},error:{padding:8,backgroundColor:\"#B00020\"},text:{textAlign:\"center\",margin:16},otherOption:{marginTop:16,borderColor:\"#DDD\",borderTopWidth:StyleSheet.hairlineWidth}});","map":{"version":3,"sources":["/home/rick/dev/cool-home/src/screens/SignInScreen.tsx"],"names":["React","Auth","createStackNavigator","Input","LoginStack","SignIn","navigation","name","route","useState","password","setPassword","username","setUsername","error","setError","isLoading","setIsLoading","handleSubmit","signIn","catch","err","message","isFirst","isFirstRouteInParent","styles","content","text","color","otherOption","navigate","goBack","SignUp","signupResult","setSignupResult","code","setCode","handleConfirm","confirmSignUp","then","console","log","signUp","res","e","codeDeliveryDetails","Destination","SignInNavigator","title","StyleSheet","create","flex","padding","justifyContent","margin","maxWidth","width","button","backgroundColor","textAlign","marginTop","borderColor","borderTopWidth","hairlineWidth"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport {\n  View,\n  Text,\n  Button,\n  StyleSheet,\n  TouchableOpacity,\n  ActivityIndicator\n} from \"react-native\";\nimport Auth from \"@aws-amplify/auth\";\nimport {\n  createStackNavigator,\n  StackNavigationProp\n} from \"@react-navigation/stack\";\nimport { RouteProp } from \"@react-navigation/core\";\nimport { ISignUpResult } from \"amazon-cognito-identity-js\";\nimport { Input } from \"../components/Elements/Input/Input\";\n\ntype LoginParams = {\n  signin: undefined;\n  signup: undefined;\n};\ntype SimpleStackNavigation = StackNavigationProp<LoginParams>;\ntype Props = {\n  navigation: SimpleStackNavigation;\n  route: RouteProp<LoginParams, keyof LoginParams>;\n};\n\nconst LoginStack = createStackNavigator<LoginParams>();\n\nconst SignIn = ({ navigation, route: { name } }: Props) => {\n  const [password, setPassword] = React.useState(\"\");\n  const [username, setUsername] = React.useState(\"\");\n  const [error, setError] = React.useState(\"\");\n  const [isLoading, setIsLoading] = React.useState(false);\n\n  function handleSubmit() {\n    setIsLoading(true);\n    Auth.signIn({ username, password }).catch(err => {\n      setIsLoading(false);\n      setError(err.message);\n    });\n  }\n\n  const isFirst = navigation.isFirstRouteInParent();\n\n  if (isLoading) {\n    return (\n      <View style={styles.content}>\n        <ActivityIndicator />\n      </View>\n    );\n  }\n\n  return (\n    <View style={styles.content}>\n      {error ? (\n        <View style={styles.error}>\n          <Text style={[styles.text, { color: \"white\" }]}>{error}</Text>\n        </View>\n      ) : null}\n      <Input\n        data-test=\"username-input\"\n        placeholder=\"Username\"\n        onChangeText={setUsername}\n      />\n      <Input\n        placeholder=\"Password\"\n        secureTextEntry\n        onChangeText={setPassword}\n        data-test=\"sign-in-password-input\"\n      />\n      <Button\n        data-test=\"sign-in-sign-in-button\"\n        onPress={handleSubmit}\n        title={\"Login\"}\n      />\n      <TouchableOpacity\n        style={styles.otherOption}\n        onPress={() =>\n          isFirst ? navigation.navigate(\"signup\") : navigation.goBack()\n        }\n      >\n        <Text style={styles.text}>{\"Or sign up here\"}</Text>\n      </TouchableOpacity>\n    </View>\n  );\n};\n\nconst SignUp = ({ navigation }: Props) => {\n  const [password, setPassword] = React.useState(\"\");\n  const [username, setUsername] = React.useState(\"\");\n  const [error, setError] = React.useState(\"\");\n  const [signupResult, setSignupResult] = React.useState<ISignUpResult>();\n  const [code, setCode] = React.useState<string>();\n\n  function handleConfirm() {\n    if (code) {\n      Auth.confirmSignUp(username, code)\n        .then(() => Auth.signIn(username, password))\n        .catch(err => console.log(err));\n    }\n  }\n\n  function handleSubmit() {\n    Auth.signUp({ username, password })\n      .then(res => setSignupResult(res))\n      .catch(e => setError(e.message));\n  }\n\n  if (signupResult) {\n    return (\n      <View style={styles.content}>\n        <Text\n          style={styles.text}\n        >{`we've your confirmation code to ${signupResult.codeDeliveryDetails.Destination}`}</Text>\n        <Input\n          key=\"code\"\n          placeholder=\"enter code here\"\n          onChangeText={setCode}\n        />\n        <Button onPress={handleConfirm} title={\"confirm code\"} />\n      </View>\n    );\n  }\n\n  return (\n    <View style={styles.content}>\n      {error ? (\n        <View style={styles.error}>\n          <Text style={[styles.text, { color: \"white\" }]}>{error}</Text>\n        </View>\n      ) : null}\n      <Input placeholder=\"Username\" onChangeText={setUsername} />\n      <Input\n        placeholder=\"Password\"\n        secureTextEntry\n        onChangeText={setPassword}\n      />\n      <Button onPress={handleSubmit} title={\"Sign up\"} />\n      <TouchableOpacity\n        style={styles.otherOption}\n        onPress={() => navigation.navigate(\"signup\")}\n      >\n        <Text style={styles.text}>{\"Or sign up here\"}</Text>\n      </TouchableOpacity>\n    </View>\n  );\n};\n\nexport const SignInNavigator = () => (\n  <LoginStack.Navigator initialRouteName=\"signin\">\n    <LoginStack.Screen\n      name={\"signin\"}\n      options={{ title: \"Sign In\" }}\n      component={SignIn}\n    />\n    <LoginStack.Screen\n      name={\"signup\"}\n      options={{ title: \"Sign Up\" }}\n      component={SignUp}\n    />\n  </LoginStack.Navigator>\n);\n\nconst styles = StyleSheet.create({\n  content: {\n    flex: 1,\n    padding: 16,\n    justifyContent: \"center\",\n    margin: \"auto\",\n    maxWidth: 500,\n    width: \"100%\"\n  },\n  button: {\n    margin: 8\n  },\n  error: {\n    padding: 8,\n    backgroundColor: \"#B00020\"\n  },\n  text: {\n    textAlign: \"center\",\n    margin: 16\n  },\n  otherOption: {\n    marginTop: 16,\n    borderColor: \"#DDD\",\n    borderTopWidth: StyleSheet.hairlineWidth\n  }\n});\n"]},"metadata":{},"sourceType":"module"}